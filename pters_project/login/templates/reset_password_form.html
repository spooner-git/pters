<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable:no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WG2KK6D');</script>
    <!-- End Google Tag Manager -->

{% load static_url %}
{% block local_css %}

    <meta name="login" content="pwreset_login">
    <link rel="stylesheet" href={% static_url "user/css/trainer/pters.trainer.register.css" %}>
    <style type="text/css">
      .NAVER{
          font-weight: 500 !important;
          color: #2DB400; 
      }
      .Facebook{
          font-weight: 500 !important;
          color: #3b5998;
      }
      .Google{
          font-weight: 500 !important;
          color: #4285f4;
      }
    	#submit_input{
    		overflow-y: hidden;
    		margin: 0;
    		transition: 0.3s;
    		-webkit-transition: 0.3s;
    		height: 260px;
    	}
    	#submit_complete{
    		height: 0;
    		transition: 0.5s;
    		-webkit-transition: 0.5s;
    		overflow-y: hidden;
    		margin: 0;
    		/*padding-left: 20px;*/
    		font-size: 14px;
    	}
    	.submit_reset_pw,.submit_go_home{
    		position: relative !important;
    		margin: 0 auto !important;
    		margin-top: 10px !important;
    		left: unset !important;
    		transform: unset !important;
    	}
      #id_email{
        width: 200px;
        height: 23px;
      }
    	.submit_go_home{
    		color: #fe4e65 !important;
    		position: relative !important;
    		margin: 0 auto !important;
    		margin-top: 15px !important;
    		left: unset !important;
    		transform: unset !important;
    	}
    	#ajaxloadingPC{
  			position: fixed;
  			display: none;
  			height: 60px;
  			left: 50%;
  			transform:translate(-50%,-50%);
  			z-index: 202;
  		}

      #errorMessageBar{
          display: none;
          width: 100%;
          position: sticky;
          top: 0;
          left: 0;
          height: 35px;
          text-align: center;
          background: red;
          color: #ffffff;
          font-size: 15px;
          font-weight: bold;
          z-index: 1500;
      }   
          #errorMessageBar span{
              line-height: 35px;
          }
          #errorMessageBar span:nth-child(2){
              position: absolute;
              right: 0;
              margin-right: 85px;
              cursor: pointer;
          }

      .outerbox_horizontal{
        display: inline-block;
        margin-left: 150px 0 10px 0;
        text-align: center;
        min-width: 275px;
        width: auto;
      }
        .outerbox_horizontal button{
          visibility: visible;
        }


    </style>

{% endblock %}
    </head>

{% load i18n %}

    <body>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WG2KK6D"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
{% block content %}
<div id="errorMessageBar">
    <span id="errorMessageText"></span><span>닫기</span>
</div>

<div class="outerbox_horizontal" data-view="init" style="width:auto;">
	<div class="explainbox _type_trainee">
		<img src="/static/user/res/login/icon-reg-user.png">
		<p><span class="font-pink">비밀번호 초기화</span><br>가입시 입력한 휴대폰 번호로 <br>초기화 링크를 전송합니다.</p>
		<div class="explaintype" id="submit_input">
			<form method="post" id="id_reset_password_form" action="" onsubmit="return false;" style="text-align: center!important;">
			  	{% csrf_token %}
                <input type="text" name="member_user_id" placeholder="ID" id="id_input" maxlength="20" autocomplete="off">
                <input type="text" name="phone" pattern="[0-9]*" style="width:40%" placeholder="'-'없이 숫자만 입력해주세요." id="id_phone_input" maxlength="11" autocomplete="off">
                <button id="id_reset_password_button" class="reset_password_button" onclick="reset_password();">인증</button>
			</form>

	</div>
</div>

{% endblock %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
	function reset_password(){
		let $form = $('#id_reset_password_form');
		$.ajax({
              //url:'/accounts/password/reset/',
              url:'/login/reset_password_sms/',
              type:'POST',
              data:$form.serialize(),
              dataType : 'html',

              beforeSend:function(){
              	beforeSend();
              },

              //보내기후 팝업창 닫기
              complete:function(){
              	completeSend()
              },

              //통신성공시 처리
              success:function(data){
                  let jsondata = JSON.parse(data);
                  console.log(jsondata);
                  if(jsondata.messageArray.length>0){
{#                    $('#errorMessageBar').show()#}
{#                    $('#errorMessageText').text(jsondata.messageArray)#}
                      alert(jsondata.messageArray);
                  }else{
                    $('#submit_complete').css('height','200px');
                    $('#submit_input').css('height','0px');
                    alert('문자를 확인해주세요.')
                  }
                  
              },

              //통신 실패시 처리
              error:function(){
                alert("서버 통신 에러가 발생하였습니다. 잠시후 다시 시도해주세요")
              },
          });
	}

  $('#errorMessageBar span:nth-child(2)').click(function(){
      $('#errorMessageBar').fadeOut()
      $('#errorMessageText').text('')
  })


	function beforeSend(){
{#        $('html').css("cursor","wait");#}
        $('#ajaxloadingPC').css('display','block');
        $('#submit_input button').css('visibility','hidden')
    }

    function completeSend(){
{#        $('html').css("cursor","auto");#}
        $('#ajaxloadingPC').css('display','none');
        $('#submit_input button').css('visibility','visible')
    }

    function goHome(){
        //location.href="{% url 'login:logout' %}";
        history.back();
    }
    function goLogin(){
        location.href="{% url 'login:logout' %}";
{#        history.back();#}
    }
</script>
    </body>
</html>