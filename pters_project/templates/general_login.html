{% extends "base.html" %}
{% load static_url %}
{% block local_css %}
    <link rel="stylesheet" href={% static_url "user/css/login/login.registration.css" %}>
{% endblock %}
{% block content %}
    <div id="root_content">
        {% for message in messages %}
            {% if message.tags == "error" %}

                <div id="errorMessageBar">
                    <span id="errorMessageText">{{ message }}</span><span>닫기</span>
                </div>

            {% endif %}
        {% endfor %}

        <div id="login_box">

            <div class="login_content" style="min-height: calc(100% - 410px);">
                <div class="pters_logo"></div>
            </div>
            <div class="login_foot">
                <form action="{% url 'login:login' %}" id="login-form" method="post">
                    <input type="hidden" name="keyword" id="keyword">
                    <input type="hidden" name="auto_login_check" value="1">
                    <input type="hidden" name="next_page" value = '{% url 'index' %}'>
                    {% csrf_token %}
                    <!-- 네이버 로그인 버튼 노출 영역 -->
                    <div class="social_login_box" onclick="location.href=naverLogin.generateAuthorizeUrl();" style="background-color: #0dd25a;">
                        <div class="social_login_img"><img src="/static/user/res/login/naver.svg" style="width: 16px; height: 14.7px; vertical-align:middle;"></div>
                        <span class="social_login_text">네이버 로그인</span>
                        <div style="display:table-cell; width:60px;"></div>
                    </div>
                    <!-- 카카오톡 로그인 버튼 노출 영역 -->
                    <div class="social_login_box" id="custom-login-btn" onclick="javascript:loginWithKakao();" style="background-color: #ffeb00; margin-top:12px;">
                        <div class="social_login_img"><img src="/static/user/res/login/naver.svg" style="width: 16px; height: 14.7px; vertical-align:middle;"></div>
                        <span class="social_login_text" style="color:#3a1c1d;">카카오톡 로그인</span>
                        <div style="display:table-cell; width:60px;"></div>
                    </div>
                    <!-- 구글 로그인 버튼 노출 영역 -->
                    <!--<div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark" style="width:179px;margin-bottom:8px;"></div>-->
                    <!-- 페이스북 로그인 버튼 노출 영역 -->
                    <!-- <fb:login-button
                      scope="public_profile, email" onlogin="checkLoginState();" class="fb-login-button" data-max-rows="1" data-size="medium" data-button-type="continue_with" data-show-faces="false" data-auto-logout-link="false" data-use-continue-as="false" style="text-align: center;display: block">
                    </fb:login-button> -->

                    <div style="width:320px; height: 1px;background:#f5f2f3; margin-top: 20px; margin-bottom: 20px;"></div>

                    <!-- PTERS 로그인 버튼 노출 영역 -->
                    <div>
                        <input class="pters_login_input" type="text" name="username" id="username_id" placeholder="아이디" autofocus>
                    </div>
                    <div style="margin-top:8px;">
                        <input class="pters_login_input" type="password" name="password" id="password_id" placeholder="비밀번호">
                    </div>
                    <div class="social_login_box" onclick="document.getElementById('login-form').submit();" style="background-color: #fe4e65; margin-top:12px;">
                        <div class="social_login_img"></div>
                        <span class="social_login_text" style="color:#ffffff;">로그인</span>
                        <div style="display:table-cell; width:60px;"></div>
                    </div>

                    <div style="width:320px; height: 1px;background:#f5f2f3; margin-top: 16px; margin-bottom: 8px;"></div>
                    <!-- 회원가입, 일반 로그인 버튼 노출 영역역 -->
                    <div style="display:table; width:100%; height: 48px; margin-bottom:20px;">
                        <div class="general_text" style="color:#858282;" onclick="location.href='{% url 'login:registration_check' %}'">회원 가입</div>
                        <div class="general_text" style="color:#858282;" onclick="location.href='{% url 'login:reset_password' %}'">비밀번호 재설정</div>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div class="album_wrap_ie" id="IE_block_explain" style="display: none;">
        <div class="album_ie" id="promote_1">
            <div class="explain_wrap_ie">
                <div class="explain_main">
                    <h1>1:1 레슨 일정/회원 관리 시스템</h1>

                    <div class="logo_label"><a href="https://www.pters.co.kr"><img src="/static/user/res/PTERS_logo_pure.png?v2" alt="PTERS" class=""></a><!-- <span class="pters_logo_text"> 피터스</span> --></div>

                    <p>일정 관리는 쉽고 빠르게</p>
                    <p>회원의 만족도는 업!</p>
                </div>
                <div class="gotoSignIn_pc">
                    <p><span class="pink_strong">MS 익스플로러</span>로 접속하신 분께서는 아래 브라우저를 설치후 이용을 부탁드립니다.</p>
                    <a href="https://www.microsoft.com/ko-kr/windows/microsoft-edge"><button class="brower_site"><img src="/static/user/res/login/browser/edge_icon.png">MS Edge</button></a>
                    <a href="https://www.mozilla.org/ko/firefox/"><button class="brower_site"><img src="/static/user/res/login/browser/firefox_icon.png">Firefox</button></a>
                    <a href="https://www.google.co.kr/chrome/index.html"><button class="brower_site"><img src="/static/user/res/login/browser/chrome_icon.png">Chrome</button></a>
                </div>
            </div>
            <div class="gotoSignIn" style="top: 65%;color: #ffffff;">
                <p><span class="pink_strong">MS 익스플로러</span>로 접속하신 분께서는 아래 브라우저를 설치후 이용을 부탁드립니다.</p>
                <a href="https://www.google.co.kr/chrome/index.html"><button class="brower_site"><img src="/static/user/res/login/browser/chrome_icon.png">Chrome</button></a>
                <a href="https://www.mozilla.org/ko/firefox/"><button class="brower_site"><img src="/static/user/res/login/browser/firefox_icon.png">Firefox</button></a>
                <a href="https://www.microsoft.com/ko-kr/windows/microsoft-edge"><button class="brower_site"><img src="/static/user/res/login/browser/edge_icon.png">MS Edge</button></a>
            </div>
        </div>
    </div>

    <form action="{% url 'login:login_simple_sns' %}" id="sns-form" method="post">
        {% csrf_token %}
        <input type="hidden" name="username" id="id_sns_username">
        <input type="hidden" name="email" id="id_sns_email">
        <input type="hidden" name="last_name" id="id_sns_last_name">
        <input type="hidden" name="first_name" id="id_sns_first_name">
        <input type="hidden" name="sns_id" id="id_new_sns_id">
        <input type="hidden" name="sns_type" id="id_sns_type" >
        <input type="hidden" name="social_accessToken" id="id_social_accessToken" >
        <input type="hidden" name="sex" id="id_sns_sex">
    </form>
{% endblock %}

{% block local_js_footer %}
<script type="text/javascript" src={% static_url "common/js/jquery.1.12.4.min.js" %}></script>
<script type="text/javascript" src={% static_url "common/js/jquery-ui.1.12.1.min.js" %}></script>
<script type="text/javascript" src={% static_url "user/js/login/pters.trainer.promote.js" %}></script>
<script type="text/javascript" src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.0.js" charset="utf-8"></script>
<script type="text/javascript" src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
<script type="text/javascript" src="https://apis.google.com/js/platform.js" async defer></script>
<script type="text/javascript">
    var varUA = navigator.userAgent.toLowerCase();//useAgent값 얻기
    var device_text = '브라우저, iOS, Android 앱으로';
    var method_text = 'PC웹(크롬, 파이어폭스, 엣지, 사파리)과 스마트폰, 태블릿 등';
    if(varUA.match('android') != null){
        device_text = '브라우저, Android 앱으로';
        method_text = 'PC, 스마트폰, 태블릿 등';
    }else if(varUA.match('iphone') !=null || varUA.match('ipad')!=null || varUA.match('ipod')!=null){
        device_text = '브라우저, iOS 앱으로';
        method_text = 'PC, 스마트폰, 태블릿 등';
    }
{#    $(window).resize(function(){#}
{#        $('.login_content').css('height', $(this).height()-$('.login_foot').height()+'px');#}
{#    });#}
    $('#connectedMethod').html(method_text);
    $('#connectedDevice').html(device_text);

    if(varUA.match('MSIE') != null || varUA.match('msie') != null || varUA.match('rv:11.0')){
        $('#album_wrap, .upperbar a, .pagination, .paginationMobile').css('display','none');
        $('#IE_block_explain').css('display','block');
    }

    $('#errorMessageBar span:nth-child(2)').click(function(){
        $('#errorMessageBar').fadeOut('fast')
    });


    window.addEventListener('load', function () {
        var val = location.href.substr(
            location.href.lastIndexOf('=') + 1
        );
        if(val=='naver'){
            location.href = naverLogin.generateAuthorizeUrl();
        }
        $.ajax({
            url:'https://nid.naver.com/oauth2.0/token?grant_type=authorization_code&client_id=VM6zl0mLyBgjf9dgw1cC&client_secret=gGI681B6TR',
            type:'POST',
            dataType : 'json',

            beforeSend:function(){
                //beforeSend();
            },

            //통신성공시 처리
            success:function(data){
                var jsondata = JSON.parse(data);
            },

            //보내기후 팝업창 닫기
            complete:function(){
            },

            //통신 실패시 처리
            error:function(){

            }
        });
    });

    <!-- 네이버아디디로로그인 초기화 Script -->
    var naverLogin = new naver.LoginWithNaverId(
        {
            clientId: "h5MuvYzSFLlrFTs19g0V",
            callbackUrl: "https://www.pters.co.kr/login/login_simple_naver/",
            //clientId: "VM6zl0mLyBgjf9dgw1cC",
            //callbackUrl: "http://localhost:8000/login/login_simple_naver/",
            isPopup: false, /* 팝업을 통한 연동처리 여부 */
            callbackHandle: false,
            loginButton: {color: "white", type: 1, height: 39} /* 로그인 버튼의 타입을 지정 */
        }
    );
    /* 설정정보를 초기화하고 연동을 준비 */
    naverLogin.init();
    // <!--  네이버아이디로로그인 초기화 Script -->


    <!-- 카카오 로그인  Script -->
    function loginWithKakao() {
        Kakao.init('4533bb10ac61e20907cd273f0941210a');
        // 로그인 창을 띄웁니다.
        Kakao.Auth.login({
            success: function(authObj) {
                location.href = '/login/login_simple_kakao/?access_token='+authObj.access_token;
            },
            fail: function(err) {
                alert(JSON.stringify(err));
            }
        });
    }

// <!-- 구글 로그인  Script -->
/*
    var google_login_check = false;
    window.addEventListener('load', function () {
        google_signOut();
    });
    function onSignIn(googleUser) {
        // Useful data for your client-side scripts:
        if(google_login_check == true){
            var profile = googleUser.getBasicProfile();
                $('#id_new_sns_id').attr('value', profile.getId());
                $('#id_sns_username').attr('value', profile.getEmail());
                $('#id_sns_email').attr('value', profile.getEmail());
                $('#id_sns_last_name').attr('value', profile.getFamilyName() +profile.getGivenName());
                $('#id_sns_first_name').attr('value', );
                $('#id_sns_type').attr('value', 'Google');
                var id_token = googleUser.getAuthResponse().id_token;
                $('#id_social_accessToken').attr('value', id_token);
                document.getElementById('sns-form').submit();
                // The ID token you need to pass to your backend:
        }
      }
    function google_signOut() {
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.signOut().then(function () {
          console.log('User signed out.');
        });
        google_login_check = true;
      }
*/
</script>
{% endblock %}
