{% extends "trainer_base.html" %}
{% load static_url %}

{% block local_css %}
    <link rel="stylesheet" href={% static_url "user/css/trainer/pters.trainer.week.cal.css" %}>
    <link rel="stylesheet" href={% static_url "user/css/trainer/pters.trainer.day.cal.css" %}>
    <link rel="stylesheet" href={% static_url "user/css/pters.mini.cal.css" %}>
    <link rel="stylesheet" href={% static_url "user/css/pters.add.style.css" %}>
    <meta name="description" content="daycal">
{% endblock %}

{% block content %}
    <img src="/static/user/res/ajax/loading.gif" alt="" class="ajaxloadingPC">
    <!-- 로딩
    <img src="/static/user/res/loader.gif" alt="데이터 로딩중" style="width:100%;" class="loaders">
      -->
    <form action="{% url 'schedule:delete_schedule' %}" id="daily-pt-delete-form" method="post">
        {% csrf_token %}
        <input type="hidden" name="schedule_id" id="id_schedule_id">
        <input type="hidden" name="member_name"   id="id_member_name_delete">
        <input type="hidden" name="en_dis_type" id="en_dis_type" value ='1'>
        <input type="hidden" name="next_page" value = '{% url 'trainer:get_trainer_schedule' %}'>
    </form>
    <form action="{% url 'schedule:delete_schedule' %}" id="daily-off-delete-form" method="post">
        {% csrf_token %}
        <input type="hidden" name="off_schedule_id" id="id_off_schedule_id">
        <input type="hidden" name="en_dis_type" id="en_dis_type" value ='0'>
        <input type="hidden" name="next_page" value = '{% url 'trainer:get_trainer_schedule' %}'>
    </form>
    <form action="{% url 'schedule:finish_schedule' %}" id="pt-finish-form" method="get">
        {% csrf_token %}
        <input type="hidden" name="schedule_id" id="id_schedule_id_finish">
        <input type="hidden" name="lecture_id"   id="id_lecture_id_finish">
        <input type="hidden" name="member_name"   id="id_member_name_finish">
        <input type="hidden" name="next_page" value = '{% url 'trainer:get_trainer_schedule' %}'>
    </form>


    <!--플로팅 버튼-->
    <div id="float_btn_wrap">
        <div id="float_btn">
            <img src={% static_url "user/res/floatbtn/btn-plus.png" %} alt="">  <!--2017.10.2-->
        </div>
        <div id="float_inner1" class="float_inner">
            <a class="KRtext">레슨<br/>일정</a><a class="JPtext">PT<br/>追加</a><a class="ENtext">Add<br/>PT</a>
        </div>
        <div id="float_inner2" class="float_inner">
            <a class="KRtext">OFF<br/>일정</a><a class="JPtext">OFF<br/>追加</a><a class="ENtext">Add<br/>OFF</a>
        </div>
    </div>

    <div id="shade3">
    </div>
    <!--플로팅 버튼-->


    <!--PC버전 Arrow-->
    <div id="ymdText" class="">
        <div class='arrowButton'>
            <a id="leftArrowButton" style="left: 4%">
                <img src="{% static_url "user/res/btn-today-left.png" %}" alt="" class="_pinkarrowbefore setunVisible" style="width: 11px;margin-top:1px;margin-right: 10px;">
                <img src="{% static_url "user/res/daycal_arrow.png" %}" alt="" id="leftArrowButtonImg">
                <span style="position: absolute;top:6px;left:-9px;font-size: 10px;color:#fe4e65;" class="_pinkarrowbefore setunVisible">Today</span>
            </a>
            <a id="rightArrowButton" style="right: 4%">
                <img src="{% static_url "user/res/daycal_arrow.png" %}" alt="" id="rightArrowButtonImg">
                <img src="{% static_url "user/res/btn-today-left.png" %}" alt="" class="_pinkarrowafter setunVisible" style="-webkit-transform:rotate(180deg);width: 11px;margin-top:1px;margin-left: 10px;">
                <span style="position: absolute;top:6px;right:-8px;font-size: 10px;color:#fe4e65;" class="_pinkarrowafter setunVisible">Today</span>
            </a>
        </div>
        <div id="yearText">
        </div>
        <div id="monthText">
        </div>
        <div id="menuName">
            <span class="KRtext">주간 일정</span>
            <span class="JPtext">週間日程</span>
            <span class="ENtext">Weekly Schedule</span>
        </div>
        <div id="menuDescription">
            <span class="KRtext">일정을 확인하고 등록 할 수 있습니다.</span>
            <span class="JPtext">スケジュールの登録・確認ができます。</span>
            <span class="ENtext">Manage schedule by week calendar</span>
        </div>
    </div>


    <div id="calendar" class="wrap _calweek">
        <div class="swiper-container">
            <div id="timeIndicatorBar"></div>
            <div class="timeindex_day">

            </div>
            <div class="swiper-wrapper">
                <div class="swiper-slide" id="slide1"></div>
                <div class="swiper-slide" id="slide2"></div>
                <div class="swiper-slide" id="slide3"></div>
            </div>
        </div>
        <div id="cal_box" class="cal_box"></div>
        <div id="gap">
        </div>

        <div class="ads_cal_insideTop ads_wrap">
            <!--달력하단_반응형_디스플레이-->
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-4554121851965192"
                 data-ad-slot="5189494227"
                 data-ad-format="auto"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
    </div>




{% endblock %}

{% block local_js_footer %}
    <!-- Bootstrap core JavaScript
        ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script>
        //front-end에서 다뤄야하는 데이터

        var krHolidayList =  [{% for holiday_day in holiday %}'{{ holiday_day.holiday_dt }}'{%if forloop.last == False%},{% endif %}{% endfor %}];//대한민국 공휴일 (구정, 추석 제외)
        var krHolidayNameList =  [{% for holiday_day in holiday %}'{{ holiday_day.holiday_name }}'{%if forloop.last == False%},{% endif %}{% endfor %}];//대한민국 공휴일 (구정, 추석 제외)

        //PT 일정 등록시 필요한 정보
        var memberIdArray =[{% for member_info in member_data %}'{{ member_info.user.id }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var memberUserIdArray =[{% for member_info in member_data %}'{{ member_info.user }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var memberNameArray = [{% for member_info in member_data %}'{{ member_info.name }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var memberAvailCountArray = [{% for member_info in member_data %}'{{ member_info.lecture_avail_count }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var memberLectureIdArray = [{% for member_info in member_data %}'{{ member_info.lecture_id }}'{%if forloop.last == False%},{% endif %}{% endfor %}];

        //OFF 일정 관련 정보
        var offScheduleIdArray = [{% for off_schedule_id_info in off_schedule_id %}'{{ off_schedule_id_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offTimeArray_start_date = [{% for off_schedule_start_datetime_info in off_schedule_start_datetime %}'{{ off_schedule_start_datetime_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offTimeArray_end_date = [{% for off_schedule_end_datetime_info in off_schedule_end_datetime %}'{{ off_schedule_end_datetime_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offScheduleNoteArray =  [{% for off_schedule_note_info in off_schedule_note %}'{{ off_schedule_note_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];

        //PT 일정 관련 정보
        //pt schedule id
        var scheduleIdArray = [{% for pt_schedule_id_info in pt_schedule_id %}'{{ pt_schedule_id_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        //pt schedule 에 해당하는 lecture id
        var classArray_lecture_id = [{% for pt_schedule_lecture_id_info in pt_schedule_lecture_id %}'{{ pt_schedule_lecture_id_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        //pt schedule 에 해당하는 회원명
        var classTimeArray_member_name = [{% for pt_schedule_member_name_info in pt_schedule_member_name %}'{{ pt_schedule_member_name_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        //pt schedule 에 해당하는 회원 ID
        var classTimeArray_member_id = [{% for pt_schedule_member_id_info in pt_schedule_member_id %}'{{ pt_schedule_member_id_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var classTimeArray_start_date = [{% for pt_schedule_start_datetime_info in pt_schedule_start_datetime %}'{{ pt_schedule_start_datetime_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var classTimeArray_end_date = [{% for pt_schedule_end_datetime_info in pt_schedule_end_datetime %}'{{ pt_schedule_end_datetime_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        //pt schedule이 끝났는지 확인
        var scheduleFinishArray =  [{% for pt_schedule_finish_check_info in pt_schedule_finish_check %}'{{ pt_schedule_finish_check_info }}'{%if forloop.last == False%},{% endif %} {% endfor %}];
        var scheduleNoteArray =  [{% for pt_schedule_note_info in pt_schedule_note %}'{{ pt_schedule_note_info }}'{%if forloop.last == False%},{% endif %} {% endfor %}];
        var scheduleIdxArray =  [{% for pt_schedule_idx_info in pt_schedule_idx %}'{{ pt_schedule_idx_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];

        var messageArray = [{% for message in messages %}'{% if message.tags == "error" %}{{ message }}{% endif %}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var RepeatDuplicationDateArray = [{% for message in messages %}'{% if message.tags == "info" %}{{ message }}{% endif %}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var repeatArray = [{{ request.session.repeat_schedule_id }}]

        var offRepeatScheduleIdArray =  [{% for off_repeat_schedule_id_info in off_repeat_schedule_id_data %}'{{ off_repeat_schedule_id_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offRepeatScheduleTypeArray =  [{% for off_repeat_schedule_type_info in off_repeat_schedule_type_data %}'{{ off_repeat_schedule_type_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offRepeatScheduleWeekInfoArray =  [{% for off_repeat_schedule_week_info_info in off_repeat_schedule_week_info_data %}'{{ off_repeat_schedule_week_info_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offRepeatScheduleStartDateArray =  [{% for off_repeat_schedule_start_date_info in off_repeat_schedule_start_date_data %}'{{ off_repeat_schedule_start_date_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offRepeatScheduleEndDateArray =  [{% for off_repeat_schedule_end_date_info in off_repeat_schedule_end_date_data %}'{{ off_repeat_schedule_end_date_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offRepeatScheduleStartTimeArray =  [{% for off_repeat_schedule_start_time_info in off_repeat_schedule_start_time_data %}'{{ off_repeat_schedule_start_time_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var offRepeatScheduleTimeDurationArray =  [{% for off_repeat_schedule_time_duration_info in off_repeat_schedule_time_duration_data %}'{{ off_repeat_schedule_time_duration_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];

        var ptRepeatScheduleIdArray =  [{% for pt_repeat_schedule_id_info in pt_repeat_schedule_id_data %}'{{ pt_repeat_schedule_id_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleTypeArray =  [{% for pt_repeat_schedule_type_info in pt_repeat_schedule_type_data %}'{{ pt_repeat_schedule_type_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleWeekInfoArray =  [{% for pt_repeat_schedule_week_info_info in pt_repeat_schedule_week_info_data %}'{{ pt_repeat_schedule_week_info_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleStartDateArray =  [{% for pt_repeat_schedule_start_date_info in pt_repeat_schedule_start_date_data %}'{{ pt_repeat_schedule_start_date_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleEndDateArray =  [{% for pt_repeat_schedule_end_date_info in pt_repeat_schedule_end_date_data %}'{{ pt_repeat_schedule_end_date_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleStartTimeArray =  [{% for pt_repeat_schedule_start_time_info in pt_repeat_schedule_start_time_data %}'{{ pt_repeat_schedule_start_time_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleTimeDurationArray =  [{% for pt_repeat_schedule_time_duration_info in pt_repeat_schedule_time_duration_data %}'{{ pt_repeat_schedule_time_duration_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleStateCdArray =  [{% for pt_repeat_schedule_state_cd_info in pt_repeat_schedule_state_cd %}'{{ pt_repeat_schedule_state_cd_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];
        var ptRepeatScheduleStateCdNameArray =  [{% for pt_repeat_schedule_state_cd_nm_info in pt_repeat_schedule_state_cd_nm %}'{{ pt_repeat_schedule_state_cd_nm_info }}'{%if forloop.last == False%},{% endif %}{% endfor %}];

        var classTimeArray = [];
        var offTimeArray = [];

        var classDateData = []
        var classTimeData = []
        var offDateData=[]
        var offTimeData = []
        var offAddOkArray = [] //OFF 등록 시작 시간 리스트
        var durAddOkArray = [] //OFF 등록 시작시간 선택에 따른 진행시간 리스트

        var addTypeSelect = "" //팝업 종류 선택 (PT or OFF)
    </script>
    <script type="text/javascript" src={% static_url "user/js/trainer/pters.trainer.cal.day.js" %}></script>
    <script>
        var myswiper = new Swiper('.swiper-container',{
            initialSlide : 1,
            speed : 120,
            preventClicks : true,
            preventClicksPropagation : true,
            keyboardControl : true,
            threshold : 50,
            resistance: 1,

        });

        $(window).scroll(function(event){
            event.stopPropagation();
        })

        var count = 0
        var count1 = 0

        $('.arrowButtonPC a:nth-child(1)').click(function(){
            if(count==0){
                myswiper.slidePrev(100)
                count++
                setTimeout(function(){count=0},200)
            }else if(count>0){
                console.log('wait!')
            }
        })

        $('.arrowButtonPC a:nth-child(2)').click(function(){
            if(count1==0){
                myswiper.slideNext(100)
                count1++
                setTimeout(function(){count1=0},200)
            }else if(count>0){
                console.log('wait!')
            }
        })

        $('#ymdText').click(function(){
            $('#calendar').fadeOut('fast','linear',function(){
                window.location.reload();
            })

        })
    </script>
    <script type="text/javascript" src={% static_url "user/js/trainer/pters.trainer.cal.add.pt.js" %}></script>
{% endblock %}