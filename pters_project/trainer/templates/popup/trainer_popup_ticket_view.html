{% extends "popup/trainer_base_popup_pagetype.html" %}
{% load static_url %}
{% load background_trainee_data %}

{% block popup_base_css %}
    <!-- pters.trainee.popup.plan_view.css -->
    <link rel="stylesheet" href={% static_url "user/css/trainer/popup/pters.trainer.popup.ticket_view.css" %}>
{% endblock %}

{% block popup_base_wrapper_top_center %}
수강권 이름
{% endblock %}

{% block popup_base_wrapper_top_right %}
설정
{% endblock %}

{% block popup_base_contents %}
    <div class="popup_ticket_view">
        <div id="wrapper_box_ticket_info">
    
        </div>

        <div class="gap"></div>

        <div id="wrapper_box_ticket_lectures">
            <div class="obj_box_full">
                <div id="toggle_ticket_lectures_list" onclick="toggle_list('#wrapper_ticket_lectures_list')">
                    <span>포함된 수업</span>
                    <img src="/static/common/icon/expand_less_black.png" alt="펼치기/접기" class="obj_icon_expand">
                </div>
            </div>
            <div class="obj_box_full" style="padding: 0;">
                <div id="wrapper_ticket_lectures_list">
                    
                </div>
            </div>
        </div>

        <div class="gap"></div>

        <div id="wrapper_box_ticket_members">
            <div class="obj_box_full">
                <div id="toggle_ticket_members_list" onclick="toggle_list('#wrapper_ticket_members_list')">
                    <span>진행중인 회원</span>
                    <img src="/static/common/icon/expand_less_black.png" alt="펼치기/접기" class="obj_icon_expand">
                </div>
            </div>
            <div class="obj_box_full" style="padding: 0;">
                <div id="wrapper_ticket_members_list">
                    
                </div>
            </div>
        </div>

        <div class="gap"></div>
        <div class="gap"></div>

    </div>
{% endblock %}

{% block popoup_base_wrapper_bottom_inside %}
    {% now "Y-m-d" as todays_date %}

    {% if date_format|date:"Y-m-d" >= todays_date and avail_end_date|date:"Y-m-d" >= date_format|date:"Y-m-d"%}
        <!-- <div class="obj_button_big obj_font_bg_white_coral" onclick="layer_popup.open_layer_popup(POPUP_AJAX_CALL, 'popup_calendar_plan_reserve', 90, POPUP_FROM_BOTTOM, {'select_date':'{{ date_format| date:'Y-m-d' }}'})">예약 추가하기</div> -->
    {% else %}
        <!-- <div class="obj_button_big obj_font_bg_pink_white" onclick="layer_popup.all_close_layer_popup()">확인</div> -->
    {% endif %}
{% endblock %}

{% block popup_base_js %}

<script>
    function toggle_list(target_selector){
        let $target = $(target_selector);
        let status = $target.attr('data-toggle');
        if(status == 0){
            $target.show(100);
            $target.attr('data-toggle', 1);
        }else if(status == undefined || status == 1){
            $target.hide(100);
            $target.attr('data-toggle', 0);
        }
    }

    class Ticket_info{
        constructor(targetHTML, instance){
            this.targetHTML = targetHTML;
            this.instance = instance;
        }

        render_basic_info(target){
            let html = `
                        <div class="obj_box_full">
                            <div id="wrapper_ticket_info_basic">
                                <div class="obj_tag obj_font_bg_grey_trans" style="line-height: 20px;">${'횟수제'}</div>
                                <div>${'30회 - 900,000 원'}</div>
                                <div>${'다가오는 여름을 준비하기 위해 기초적인 수업들로 구성된 수강권입니다.'}</div>
                            </div>
                            <div id="wrapper_ticket_info_dates">
                                <div>수정 <span>${'2019.06.24'}</span></div>
                                <div>개설 <span>${'2019.06.21'}</span></div>
                            </div>
                        </div
                        >`
            document.querySelector(target).innerHTML = html;
        }

        render_include_lecture_info(target){
            let html_to_join = [];
            for(var i=0; i<3; i++){
                let html = 
                            `
                            <li onclick="open_lecture_info_popup('123')">
                                <div class="lecture_data_l">
                                    <div class="lecture_tag_body" style="background:#fe4e65"></div>
                                    <div class="lecture_tag_head" style="border-left-color:#fe4e65"></div>
                                </div>
                                <div class="lecture_data_c">
                                    <div class="lecture_name">수강권 이름</div>
                                </div>
                                <div class="lecture_data_r">
                                    <div class="lecture_member_number">정원 - ${i}명
                                    </div>
                                    <div class="lecture_member_number">참여중 - 101명
                                    </div>
                                </div>
                            </li>
                            `
                html_to_join.push(html);
            }
            document.querySelector(target).innerHTML = `<ul>${html_to_join.join('')}</ul>`;
        }

        render_include_member_info(target){
            let html_to_join = [];
            for(var i=0; i<3; i++){
                let html = 
                            `
                            <li onclick="open_member_info_popup('123')">
                                <div class="member_data_l">
                                    <img src="/static/common/icon/icon_account.png">
                                </div>                
                                <div class="member_data_c">
                                    <div class="member_name">회원명</div>
                                </div>
                                <div class="member_data_r">
                                    <div class="member_counts">10회</div>
                                </div>
                            </li>
                            `
                html_to_join.push(html);
            }
            document.querySelector(target).innerHTML = `<ul>${html_to_join.join('')}</ul>`;

                        
        }
    }

    let ticket_info_popup = new Ticket_info('.popup_ticket_view', 'ticket_info_popup');
    ticket_info_popup.render_basic_info('#wrapper_box_ticket_info');
    ticket_info_popup.render_include_lecture_info('#wrapper_ticket_lectures_list');
    ticket_info_popup.render_include_member_info('#wrapper_ticket_members_list');




    func_set_webkit_overflow_scrolling('.popup_ticket_view');
</script>
{% endblock %}
