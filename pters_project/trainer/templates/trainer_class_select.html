{% extends "trainee_base.html" %}
{% load static %}

{% block local_css %}
        <link rel="stylesheet" href={% static "user/css/trainee/pters.trainee.select.teacher.css" %}>
        <style type="text/css">
          #myClassCreate{
            display: block;
          }
          #myClassSetting{
            display: none;
          }
        </style>
{% endblock %}

{% block content %}

<form action="{% url 'trainer:add_class_info' %}" id="add-class-info-form" method="post">
  <input type="hidden" name="center_id" id="center_id" value=""> <!--강좌 센터 -->
  <input type="hidden" name="subject_cd" id="subject_cd" value=""> <!--강좌 코드-->
  <input type="hidden" name="start_date" id="start_date" value=""> <!--강좌 시작 일자-->
  <input type="hidden" name="end_date" id="end_date" value=""> <!--강좌 종료 일자-->
  <input type="hidden" name="class_hour" id="class_hour" value=1> <!--강좌 진행 시간-->
  <input type="hidden" name="start_hour_unit" id="start_hour_unit" value="1"> <!--강좌 시작 시간(1: 정시, 0.5: 30분단위-->
  <input type="hidden" name="class_member_num" id="class_member_num" value="1"> <!--강좌 수업별 최대 허용 인원-->


  <input type="hidden" name="setting_trainer_lecture_create" id="id_setting_lecture_create" value=""> <!--신규 강의 이름-->
  <input type="hidden" name="setting_trainer_work_time_available" id="id_setting_trainer_work_time" value=""> <!--min 00:00 max 23:59  업무 시간 설정 -->
  <input type="hidden" name="setting_member_reserve_time_available" id="id_setting_member_available_time" value=""> <!--min 00:00 max 23:59   회원 예약 허용 시간대-->
  <input type="hidden" name="setting_member_reserve_time_prohibition"   id="id_setting_member_reserve_time_prohibition" value=""> <!--시간 숫자-->
  <input type="hidden" name="setting_member_reserve_prohibition"   id="id_setting_member_reserve_prohibition" value=""> <!--예약금지 활성 1, 비활성 0-->
  <input type="hidden" name="next_page" value = '{% url 'trainer:index' %}'>
</form>

<div id="myClassCreate">
    <label>1. 나의 클래스 만들기</label>
    <div>
        <p>나의 클래스를 추가합니다. <br>
          (예: PT, 요가, 필라테스, 발레, 미술 등)
        </p>
        <p>클래스는 설정에서 언제든지 추가가 할수 있습니다.</p>
    </div>
    <div>
        <label>만들고 하는 클래스명을 입력해주세요.</label>
        <input type="" name="new_class_name" placeholder="클래스명(최대 10자)" maxlength="10">
    </div>


    <div class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">선택<span class="caret"></span></button>
        <ul id="center_list" class="dropdown-menu">
            {% for center_info in center_list %}
              <li><a data-time="{{ center_info.center_id }}">{{ center_info.center.center_name }}</a></li>
            {% endfor %}
        </ul>
    </div>

    <div class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">선택<span class="caret"></span></button>
        <ul id="class_type" class="dropdown-menu">
            {% for class_type_cd_info in class_type_cd_data %}
              <li><a data-time="{{ class_type_cd_info.common_cd }}">{{ class_type_cd_info.common_cd_nm }}</a></li>
            {% endfor %}
        </ul>
    </div>

    {% for class_type_cd_info in class_type_cd_data %}
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">선택<span class="caret"></span></button>
            <ul id="subject_type_{{ forloop.counter }}" class="dropdown-menu" display="none">
                {% for subject_type in class_type_cd_info.subject_type_cd %}
                  <li><a data-time="{{ subject_type.common_cd }}">{{ subject_type.common_cd_nm }}</a></li>
                {% endfor %}
            </ul>
        </div>
    {% endfor %}
    <button  onclick="goNext('0')">다음</button>
</div>

<div id="myClassSetting">
    <label>2. 나의 클래스 설정</label>
    <div>
        <p>클래스 정보를 설정합니다. <br>
          (나의 업무시간, 회원 예약 기능 켜고 끄기, 회원 예약 시간대 설정)
        </p>
        <p>클래스는 설정에서 언제든지 추가가 할수 있습니다.</p>
    </div>
    <div>
        <label>나의 업무시간 설정</label>
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">선택<span class="caret"></span></button>
            <ul id="myWorkTimeStart" class="dropdown-menu">
              <li><a data-time="0">오전 0시</a></li>
              <li><a data-time="1">오전 1시</a></li>
              <li><a data-time="2">오전 2시</a></li>
              <li><a data-time="3">오전 3시</a></li>
              <li><a data-time="4">오전 4시</a></li>
              <li><a data-time="5">오전 5시</a></li>
              <li><a data-time="6">오전 6시</a></li>
              <li><a data-time="7">오전 7시</a></li>
              <li><a data-time="8">오전 8시</a></li>
              <li><a data-time="9">오전 9시</a></li>
              <li><a data-time="10">오전 10시</a></li>
              <li><a data-time="11">오전 11시</a></li>
              <li><a data-time="12">오후 12시</a></li>
              <li><a data-time="13">오후 1시</a></li>
              <li><a data-time="14">오후 2시</a></li>
              <li><a data-time="15">오후 3시</a></li>
              <li><a data-time="16">오후 4시</a></li>
              <li><a data-time="17">오후 5시</a></li>
              <li><a data-time="18">오후 6시</a></li>
              <li><a data-time="19">오후 7시</a></li>
              <li><a data-time="20">오후 8시</a></li>
              <li><a data-time="21">오후 9시</a></li>
              <li><a data-time="22">오후 10시</a></li>
              <li><a data-time="23">오후 11시</a></li>
            </ul>
        </div>
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">선택<span class="caret"></span></button>
            <ul id="myWorkTimeEnd" class="dropdown-menu">
              
            </ul>
        </div>

        <label>나의 회원님 예약 기능 여부</label>
        <p>OFF로 설정시 나의 회원님은 본인의 스케쥴 확인만 가능하고, 예약 및 취소는 불가능 합니다.</p>
        <button class="reserveOnOffToggle" data-onoff='1'>회원 예약 기능 켜기</button>
        <button class="reserveOnOffToggle" data-onoff='0'>회원 예약 기능 끄기</button>

        <label>나의 회원님 예약 가능 시간대</label>
        <p>나의 회원님께서 일정을 예약하거나 취소할 수 있는 시간대를 설정합니다.</p>
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">선택<span class="caret"></span></button>
            <ul id="myReserveTimeStart" class="dropdown-menu">
              <li><a data-time="0">오전 0시</a></li>
              <li><a data-time="1">오전 1시</a></li>
              <li><a data-time="2">오전 2시</a></li>
              <li><a data-time="3">오전 3시</a></li>
              <li><a data-time="4">오전 4시</a></li>
              <li><a data-time="5">오전 5시</a></li>
              <li><a data-time="6">오전 6시</a></li>
              <li><a data-time="7">오전 7시</a></li>
              <li><a data-time="8">오전 8시</a></li>
              <li><a data-time="9">오전 9시</a></li>
              <li><a data-time="10">오전 10시</a></li>
              <li><a data-time="11">오전 11시</a></li>
              <li><a data-time="12">오후 12시</a></li>
              <li><a data-time="13">오후 1시</a></li>
              <li><a data-time="14">오후 2시</a></li>
              <li><a data-time="15">오후 3시</a></li>
              <li><a data-time="16">오후 4시</a></li>
              <li><a data-time="17">오후 5시</a></li>
              <li><a data-time="18">오후 6시</a></li>
              <li><a data-time="19">오후 7시</a></li>
              <li><a data-time="20">오후 8시</a></li>
              <li><a data-time="21">오후 9시</a></li>
              <li><a data-time="22">오후 10시</a></li>
              <li><a data-time="23">오후 11시</a></li>
            </ul>
        </div>
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">선택<span class="caret"></span></button>
            <ul id="myReserveTimeEnd" class="dropdown-menu">

            </ul>
        </div>
    </div>
    <button onclick="goNext('1')">완료</button>
</div>


{% endblock %}

{% block local_js_footer %}
        <!-- for db by hk.kim 170805-->
        <script>
          /*
          $('#popup_lecture_select').show().css('top','40%')
          ajax_read_lecture_info_from_db()
          */
          $('#pcver').css('background','#e2e2e2')
          $('.centermenu_text').css('color','#b1b1b1').attr('onclick','')
          $('#loginInfo').attr('onclick','')      
          $('.button_close_popup').hide()

          $('#upbutton').attr('onclick','')
          $('#upbutton img').css('opacity','0.2')





          //시간 설정 관련 드랍다운 채우기

          /*강의 이름 입력*/
          $('#myClassCreate input').keyup(function(){
            $('#id_setting_lecture_create').val($(this).val())
          })
          /*강의 이름 입력*/


          /*업무 시간 설정*/
          $("#myWorkTimeStart li a").click(function(){
                $("#myWorkTimeStart").siblings('button').addClass("dropdown_selected").text($(this).text()).val($(this).attr('data-time'));
                var availableTime = make_available_date_format($('#myWorkTimeStart'),$('#myWorkTimeEnd'))
                $('#id_setting_trainer_work_time').val(availableTime)
                fill_dropdown_reserve_endtime($(this).attr('data-time'),$('#myWorkTimeEnd'))
                check_dropdown_selected();
          });
          $(document).on('click',"#myWorkTimeEnd li a",function(){
                $("#myWorkTimeEnd").siblings('button').addClass("dropdown_selected").text($(this).text()).val($(this).attr('data-time'));
                var availableTime = make_available_date_format($('#myWorkTimeStart'),$('#myWorkTimeEnd'))
                $('#id_setting_trainer_work_time').val(availableTime)
                check_dropdown_selected();
          });
          /*업무 시간 설정*/

          /*회원 예약 허용 시간대 설정*/
          $("#myReserveTimeStart li a").click(function(){
                $("#myReserveTimeStart").siblings('button').addClass("dropdown_selected").text($(this).text()).val($(this).attr('data-time'));
                var availableTime = make_available_date_format($('#myReserveTimeStart'),$('#myReserveTimeEnd'))
                $('#id_setting_member_available_time').val(availableTime)
                fill_dropdown_reserve_endtime($(this).attr('data-time'),$('#myReserveTimeEnd'))

                check_dropdown_selected();
          });
          $(document).on('click',"#myReserveTimeEnd li a",function(){
                $("#myReserveTimeEnd").siblings('button').addClass("dropdown_selected").text($(this).text()).val($(this).attr('data-time'));
                var availableTime = make_available_date_format($('#myReserveTimeStart'),$('#myReserveTimeEnd'))
                $('#id_setting_member_available_time').val(availableTime)
                check_dropdown_selected();
          });
          /*회원 예약 허용 시간대 설정*/

          $('.reserveOnOffToggle').click(function(){
              $(this).addClass('selected')
              $(this).siblings('.reserveOnOffToggle').removeClass('selected')
              $('#id_setting_member_reserve_prohibition').val($(this).attr('data-onoff'))
          })
          //시간 설정 관련 드랍다운 채우기


          function make_available_date_format(button1, button2){
              var $hourselect = button1
              var $hourselect2 = button2
              var starthour = $hourselect.val() 
              var endhour = $hourselect2.val() 
              if(starthour == "24"){
                var starthour = "23:59"
              }else{
                var starthour = $hourselect.find('button').val() + ':00'
              }
              if(endhour == "24"){
                var endhour = "23:59"
              }else{
                var endhour = $hourselect2.find('button').val() + ':00'
              }
              var availableTime = starthour+'-'+endhour
              return availableTime
          }

          function fill_dropdown_reserve_endtime(starttime, ultarget){
            var array = []
            for(var i=Number(starttime)+1; i<=24; i++){
              if(i==24){
                array.push('<li><a data-time="'+i+'">오전 12시</a></li>')   
              }else if(i<12){
                array.push('<li><a data-time="'+i+'">오전 '+i+'시</a></li>')   
              }else if(i==12){
                array.push('<li><a data-time="'+i+'">오후 '+i+'시</a></li>')   
              }else if(i>=12){
                array.push('<li><a data-time="'+i+'">오후 '+(i-12)+'시</a></li>')   
              }
            }
            target.siblings('button').val('').text('')
            target.html(array.join(''))
          }

          function goNext(option){
              if(option == "0"){
                $('#myClassCreate').css('display','none')
                $('#myClassSetting').css('display','block')
              }else if(option == "1"){
                location.href="{% url 'home' %}"
              }
          }


        </script>

{% endblock %}
